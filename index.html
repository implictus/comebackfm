<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Comeback FM - F1-F4 Presets</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #121212;
            color: #ffffff;
            overflow: hidden;
        }

        body {
            display: flex;
            flex-direction: column;
        }

        .header {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            padding: 12px;
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6);
            border-bottom: 3px solid #007ACC;
            flex-shrink: 0;
            min-height: 100px;
        }

        .preset-button {
            background: linear-gradient(135deg, #2d2d2d 0%, #3d3d3d 100%);
            border: 3px solid #4A4A4A;
            border-radius: 12px;
            color: #ffffff;
            font-size: 28px;
            font-weight: 700;
            cursor: pointer;
            padding: 16px 24px;
            min-width: 75px;
            min-height: 75px;
            transition: all 0.15s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: manipulation;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            position: relative;
            overflow: hidden;
        }

        .preset-button:hover {
            background: linear-gradient(135deg, #3d3d3d 0%, #4d4d4d 100%);
            border-color: #007ACC;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 122, 204, 0.3);
        }

        .preset-button:active {
            transform: scale(0.95);
        }

        .preset-button.pressed {
            background: linear-gradient(135deg, #1DB954 0%, #2dd975 100%);
            border-color: #1DB954;
            box-shadow: 0 0 30px rgba(29, 185, 84, 0.6), inset 0 0 20px rgba(29, 185, 84, 0.2);
            animation: pressFlash 0.3s ease;
        }

        @keyframes pressFlash {
            0% {
                transform: scale(1);
                box-shadow: 0 0 30px rgba(29, 185, 84, 0.6);
            }
            50% {
                box-shadow: 0 0 50px rgba(29, 185, 84, 0.9);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 0 30px rgba(29, 185, 84, 0.6);
            }
        }

        .status-bar {
            background: #1a1a1a;
            padding: 8px 12px;
            font-size: 12px;
            color: #888;
            border-top: 1px solid #2d2d2d;
            min-height: 30px;
            display: flex;
            align-items: center;
            flex-shrink: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #4A4A4A;
            border-radius: 50%;
            margin-right: 8px;
            flex-shrink: 0;
        }

        .status-indicator.active {
            background: #1DB954;
            animation: statusPulse 0.6s ease;
        }

        @keyframes statusPulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.4;
            }
        }

        .iframe-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            background: #000;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
            flex: 1;
        }

        @media (max-width: 480px) {
            .header {
                min-height: 85px;
                gap: 8px;
            }

            .preset-button {
                font-size: 24px;
                padding: 12px 18px;
                min-width: 65px;
                min-height: 65px;
            }
        }

        @media (orientation: landscape) {
            .header {
                min-height: 70px;
                gap: 8px;
            }

            .preset-button {
                font-size: 20px;
                padding: 10px 16px;
                min-width: 55px;
                min-height: 55px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <button class="preset-button" data-preset="F1" onclick="injectKeyboardEvent('F1')">F1</button>
        <button class="preset-button" data-preset="F2" onclick="injectKeyboardEvent('F2')">F2</button>
        <button class="preset-button" data-preset="F3" onclick="injectKeyboardEvent('F3')">F3</button>
        <button class="preset-button" data-preset="F4" onclick="injectKeyboardEvent('F4')">F4</button>
    </div>

    <div class="status-bar">
        <span class="status-indicator" id="statusIndicator"></span>
        <span id="statusText">Gereed</span>
    </div>

    <div class="iframe-container">
        <iframe id="fmTunerFrame" src="https://comebackfm.fmtuner.org/"></iframe>
    </div>

    <script>
        const iframe = document.getElementById('fmTunerFrame');
        const statusText = document.getElementById('statusText');
        const statusIndicator = document.getElementById('statusIndicator');

        function getKeyCode(keyName) {
            const keyCodes = {
                'F1': 112,
                'F2': 113,
                'F3': 114,
                'F4': 115
            };
            return keyCodes[keyName] || 0;
        }

        function injectKeyboardEvent(keyName) {
            console.log(`\n========== ${keyName} BUTTON PRESSED ==========`);
            
            const button = document.querySelector(`[data-preset="${keyName}"]`);
            
            // Visual feedback
            button.classList.add('pressed');
            statusIndicator.classList.add('active');
            updateStatus(`${keyName} verstuurd...`);

            setTimeout(() => {
                button.classList.remove('pressed');
                statusIndicator.classList.remove('active');
            }, 300);

            const keyCode = getKeyCode(keyName);

            try {
                if (!iframe.contentWindow) {
                    console.log('âŒ FOUT: iframe.contentWindow is niet beschikbaar');
                    updateStatus('âŒ Iframe niet toegankelijk');
                    return;
                }

                console.log('âœ“ iframe.contentWindow beschikbaar');

                // Create keyboard event with all necessary properties
                const eventInit = {
                    key: keyName,
                    code: keyName,
                    keyCode: keyCode,
                    which: keyCode,
                    bubbles: true,
                    cancelable: true,
                    view: iframe.contentWindow,
                    // Additional properties for better compatibility
                    charCode: 0,
                    location: 0,
                    repeat: false,
                    ctrlKey: false,
                    altKey: false,
                    shiftKey: false,
                    metaKey: false
                };

                console.log('Event eigenschappen:', eventInit);

                // Create and dispatch keydown event
                const keydownEvent = new KeyboardEvent('keydown', eventInit);
                console.log('Created keydown event:', keydownEvent);

                // Dispatch targets in order of priority
                const dispatchTargets = [
                    {
                        name: 'iframe.contentWindow',
                        target: iframe.contentWindow
                    },
                    {
                        name: 'iframe.contentDocument',
                        target: iframe.contentDocument
                    },
                    {
                        name: 'iframe.contentDocument.documentElement',
                        target: iframe.contentDocument.documentElement
                    },
                    {
                        name: 'iframe.contentDocument.body',
                        target: iframe.contentDocument.body
                    },
                    {
                        name: 'window (parent)',
                        target: window
                    },
                    {
                        name: 'document (parent)',
                        target: document
                    }
                ];

                console.log('\n--- DISPATCHING KEYDOWN EVENT ---');
                let successCount = 0;

                for (const dispatch of dispatchTargets) {
                    try {
                        if (dispatch.target) {
                            const result = dispatch.target.dispatchEvent(keydownEvent);
                            console.log(`âœ“ Keydown dispatched to ${dispatch.name} - preventDefault possible: ${!result}`);
                            successCount++;
                        }
                    } catch (err) {
                        console.log(`âœ— Failed to dispatch to ${dispatch.name}: ${err.message}`);
                    }
                }

                // Wait a bit, then dispatch keyup event
                setTimeout(() => {
                    const keyupEvent = new KeyboardEvent('keyup', eventInit);
                    
                    console.log('\n--- DISPATCHING KEYUP EVENT ---');

                    for (const dispatch of dispatchTargets) {
                        try {
                            if (dispatch.target) {
                                const result = dispatch.target.dispatchEvent(keyupEvent);
                                console.log(`âœ“ Keyup dispatched to ${dispatch.name} - preventDefault possible: ${!result}`);
                            }
                        } catch (err) {
                            console.log(`âœ— Failed to dispatch to ${dispatch.name}: ${err.message}`);
                        }
                    }

                    console.log('\n========== EVENT INJECTION COMPLETE ==========\n');
                }, 50);

                console.log(`âœ“ ${keyName} event injection started successfully (${successCount} targets)`);
                updateStatus(`${keyName} naar iframe verstuurd`);

            } catch (error) {
                console.error('âŒ FOUT bij event injection:', error);
                console.error('Error stack:', error.stack);
                updateStatus('âŒ Fout bij versturen');
            }
        }

        function updateStatus(message) {
            statusText.textContent = message;
        }

        // Listen for physical F1-F4 key presses
        document.addEventListener('keydown', (e) => {
            if (['F1', 'F2', 'F3', 'F4'].includes(e.key)) {
                e.preventDefault();
                console.log(`Fysieke ${e.key} toets ingedrukt`);
                injectKeyboardEvent(e.key);
            }
        });

        // Initialize console logging
        console.log('%c=== COMEBACK FM KEYBOARD EVENT INJECTOR ===', 'color: #1DB954; font-size: 16px; font-weight: bold;');
        console.log('%cGereed voor F1-F4 knop klikken of toetsenbord input', 'color: #007ACC; font-size: 12px;');
        console.log('Open de browser console (F12) om event logging te zien');
        
        updateStatus('Gereed - Klik F1, F2, F3 of F4');
    </script>
</body>
</html>
</function_calls>

Perfect! Ik heb nu een **robuuste keyboard event injector** gemaakt die **meerdere dispatch strategieÃ«n** gebruikt.

**âœ¨ Hoe het werkt:**

1. **4 Grote knoppen (F1-F4)** in een horizontale rij
2. **Fullscreen iframe** eronder met de FM tuner pagina
3. Wanneer je een knop klikt, stuurt de app keyboard events naar:
   - `iframe.contentWindow` (primair)
   - `iframe.contentDocument` 
   - `iframe.contentDocument.documentElement`
   - `iframe.contentDocument.body`
   - Parent window/document (fallback)

4. **Echte KeyboardEvent** met alle juiste eigenschappen:
   - `key`, `code`, `keyCode`, `which`
   - `bubbles: true, cancelable: true`
   - Alle modifier toetsen correct ingesteld

5. **Console logging** voor debugging - open F12 om alles te zien!

**ðŸŽ¯ Features:**

âœ… Stuurt zowel `keydown` als `keyup` events  
âœ… Meerdere dispatch targets voor maximale compatibiliteit  
âœ… Visuele feedback (knop wordt groen)  
âœ… Status meldingen onderaan  
âœ… Console logging voor elke event  
âœ… Ondersteunt fysieke F1-F4 toetsen ook  
âœ… Responsive design voor alle schermen  

**ðŸ“± Debugging:**

Open de **browser console (F12)** en je ziet:
- Welke targets de event ontvangt
- Of de dispatch succesvol was
- Of `preventDefault` mogelijk is

**ðŸ’¡ Als het nog niet werkt:**

1. Zet de telefoon in "Desktop Site" mode in Chrome
2. Check de console voor error meldingen
3. De FM tuner pagina moet naar keyboard events luisteren

Werkt het nu veel beter? ðŸš€
